<div class="container">
  <h1>Minha Conta</h1>

  <div class="account-header">
    <div class="profile-photo-wrapper">
    <img [src]="user?.photoUrl || 'assets/profile.png'" alt="Foto de Perfil" class="profile-photo" />
    <label class="profile-photo-edit-btn">
      <input type="file" (change)="onPhotoSelected($event)" accept="image/*" hidden>
      <span class="material-icons">photo_camera</span>
    </label>
    </div>
    <div class="account-info">
      <p><strong>Nome:</strong> {{ user?.name }}</p>
      <p><strong>Email:</strong> {{ user?.email }}</p>
      <p><strong>Tipo Sanguíneo:</strong> {{ user?.bloodType }}</p>
      <!-- outros dados -->
      <button type="button" (click)="onEditProfile()"
      [disabled]="changePasswordMode">Editar Perfil</button>
      <button type="button" (click)="onChangePassword()" 
      [disabled]="editProfileMode">Alterar Senha</button>
    </div>
  </div>

  <hr />

  <form *ngIf="editProfileMode && editUser">
    <label>
      Nome:
      <input type="text" [(ngModel)]="editUser.name" name="name" />
    </label>
    <label>
      Email:
      <input type="email" [(ngModel)]="editUser.email" name="email" />
    </label>
    <!-- outros campos editáveis -->
    <label>
      <button type="button" (click)="saveProfile()">Salvar</button>
      <button type="button" (click)="cancelEdit()">Cancelar</button>
    </label>
  </form>

  <form *ngIf="changePasswordMode">
    <label>
      Nova senha:
      <input type="password" [(ngModel)]="newPassword" name="password" />
    </label>
    <label>
      <button type="button" (click)="savePassword()">Salvar Senha</button>
      <button type="button" (click)="cancelPassword()">Cancelar</button>
    </label>
  </form>

  <div class="account-details">
    <p><strong>Última doação:</strong> {{ user?.lastDonation | date:'dd/MM/yyyy' }}</p>
    <p><strong>Próxima doação possível:</strong> {{ user?.nextEligibleDonation | date:'dd/MM/yyyy' }}</p>
  </div>

  <div class="last-questionnaire" *ngIf="lastQuestionnaire">
    <h2>Último Questionário de Doação</h2>
    <p><strong>Data:</strong> {{ lastQuestionnaire.date | date:'dd/MM/yyyy' }}</p>
    <ul>
      <li *ngFor="let item of lastQuestionnaire.answers">
        <strong>{{ item?.question }}</strong> <br>
        Resposta: {{ item?.answer }}
      </li>
    </ul>
  </div>

  <div class="achievements-section" *ngIf="user?.achievements?.length">
    <h2>Conquistas</h2>
    <div class="badges-list">
      <div class="badge" *ngFor="let badge of user?.achievements">
        <img [src]="badge.iconUrl" [alt]="badge.title" />
        <span class="badge-title">{{ badge.title }}</span>
        <span class="badge-desc">{{ badge.description }}</span>
      </div>
    </div>
  </div>

  <ng-template #viewProfile>
    <div class="account-info">
      <p><strong>Nome:</strong> {{ user?.name }}</p>
      <p><strong>Email:</strong> {{ user?.email }}</p>
      <button type="button" (click)="onEditProfile()" 
      [disabled]="changePasswordMode">Editar Perfil</button>
    </div>
  </ng-template>
</div>