<ng-container *ngIf="user?.role === 'partner'">
  <ng-container *ngIf="partnerUser as partner">
    <div *ngIf="!editProfileMode">
      <div class="app-card">
        <div class="app-card-header">
          <i class="fa-solid fa-store app-card-icon"></i>
          <h2 class="app-card-title">Perfil do Parceiro</h2>
        </div>
        <div class="account-header">
          <div class="profile-photo-wrapper">
            <img [src]="partner.photoUrl || 'assets/partner.png'" alt="Foto do Parceiro" class="profile-photo" />
            <input #fileInput type="file" (change)="onPhotoSelected($event)" accept="image/*" hidden>
            <button type="button" class="profile-photo-edit-btn" (click)="fileInput.click()">
              Trocar Foto
            </button>
          </div>
          <div class="account-info">
            <p><strong>Nome:</strong> {{ partner.name }}</p>
            <p><strong>Email:</strong> {{ partner.email }}</p>
            <p><strong>Endereço:</strong> {{ partner.address }}</p>
            <p><strong>Telefone:</strong> {{ partner.phone }}</p>
            <p><strong>CNPJ:</strong> {{ partner.cnpj }}</p>
            <button type="button" (click)="onEditProfile()">Editar Perfil</button>
          </div>
        </div>
      </div>
      <div class="app-card">
        <div class="app-card-header">
          <i class="fa-solid fa-gift app-card-icon"></i>
          <h2 class="app-card-title">Ofertas para Usuários</h2>
        </div>
        <!-- Formulário de adicionar/editar oferta -->
        <form *ngIf="addOfferMode || editOfferMode" (ngSubmit)="saveOffer()" style="margin-bottom: 1.5rem;">
          <label>
            Título:
            <input type="text" [(ngModel)]="offerForm.title" name="offerTitle" required />
          </label>
          <label>
            Descrição:
            <input type="text" [(ngModel)]="offerForm.description" name="offerDescription" required />
          </label>
          <label>
            Ativa:
            <input type="checkbox" [(ngModel)]="offerForm.active" name="offerActive" />
          </label>
          <label>
            <button type="submit">Salvar</button>
            <button type="button" (click)="cancelOfferForm()">Cancelar</button>
          </label>
        </form>
        <ul>
          <li *ngFor="let offer of partner.offer; let i = index">
            <div class="offer-info">
              <strong>{{ offer.title }}</strong> - {{ offer.description }}
              <span *ngIf="offer.active" style="color: green;">(Ativa)</span>
            </div>
            <div class="offer-actions">
              <button (click)="editOffer(offer, i)">Editar</button>
              <button (click)="removeOffer(offer)">Remover</button>
            </div>
          </li>
        </ul>
        <button (click)="addOffer()" *ngIf="!addOfferMode && !editOfferMode">Adicionar Nova Oferta</button>
      </div>
    </div>

    <!-- Formulário de edição -->
    <form *ngIf="editProfileMode && editUser">
      <label>
        Nome:
        <input type="text" [(ngModel)]="partner.name" name="name" />
      </label>
      <label>
        Email:
        <input type="email" [(ngModel)]="partner.email" name="email" />
      </label>
      <label>
        Endereço:
        <input type="text" [(ngModel)]="partner.address" name="address" />
      </label>
      <label>
        Telefone:
        <input type="text" [(ngModel)]="partner.phone" name="phone" />
      </label>
      <label>
        CNPJ:
        <input type="text" [(ngModel)]="partner.cnpj" name="cnpj" />
      </label>
      <label>
        <button type="button" (click)="saveProfile()">Salvar</button>
        <button type="button" (click)="cancelEdit()">Cancelar</button>
      </label>
    </form>
  </ng-container>
</ng-container>
